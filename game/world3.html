<html>
  <head>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://castelletm12b.cat/build/assets/question.js" defer></script>
    <script>

      AFRAME.registerComponent("mylink", {
      init: function() {  
       this.el.addEventListener("click", (e) => {              
          window.location = this.data.href;      
         })
      }
    })

    AFRAME.registerComponent("click-desapareix", {
    init: function () {
      this.el.addEventListener("click", () => {
        this.el.setAttribute("visible", "false");
      });
    }
  });

  </script>
  </head>

  <body>

    <a-scene cursor="rayOrigin: mouse">
      
      <a-assets>

        <img id="mia" src="8.jpg">
        <a-asset-item id="ladderz" src="Assets/TEX3/Ladderz/scene.gltf"></a-asset-item>
        <a-asset-item id="scroll" src="Assets/TEX3/script/scene.gltf"></a-asset-item>
        <a-asset-item id="knife" src="Assets/TEX3/Knivez/scene.gltf"></a-asset-item>7
        <audio id="musica" src="Assets/mus/mus_islandview.mp3" preload="auto"></audio>

      </a-assets>

      <a-entity camera look-controls wasd-controls="false">

        <a-entity cursor="fuse: true; fuseTimeout: 2000"
                  position="0 0 -1"
                  geometry="primitive: ring; radiusInner: 0.02; radiusOuter: 0.03"
                  material="color: red; shader: flat"
                  animation="property: components.material.material.color;
                            type: color;
                            to: white;
                            dur: 1000;
                            dir: alternate;
                            loop: true">
        </a-entity>

      </a-entity>

      <a-entity sound="src: #musica; autoplay: true; loop: true; volume: 0.5"></a-entity>

      <a-sky src="#mia" material="shader: standard;"></a-sky>

      <a-entity gltf-model="#ladderz" position="-550 500 0" rotation="0 90 0" scale="2 2 2"></a-entity>

      <a-entity question="103" gltf-model="#scroll" id="dialeg" position="-0.3 -0.8 -0.5" rotation="0 0 360" scale="0.5 0.5 0.5"></a-entity>   

      <a-entity id="matxet" gltf-model="#knife" scale="-1 -1 -1" position="10 -7 10" animation="property: rotation; to: 0 360 0; dur: 4000; loop: true" visible="false" click-desapareix></a-entity>

    </a-scene>

    <script>

      document.addEventListener("DOMContentLoaded", () => {
        const haTornat = localStorage.getItem("tornarDeWorld4");
        
        if (haTornat === "true") {
          
          const matxet = document.querySelector("#matxet");
          
          if (matxet) {
          
            matxet.setAttribute("visible", "true");
      
          }
          
          localStorage.removeItem("tornarDeWorld4");
        
        }
      
      });

      </script>

  </body>
</html>
